{-# OPTIONS_GHC -fno-warn-orphans #-}

-- Derived from AWS service descriptions, licensed under Apache 2.0.

{% include "_include/license.ede" %}
--
module {{ moduleName }} where

import Data.Proxy
import Test.AWS.Fixture
import Test.Tasty
{% for import in moduleImports %}
import {{ import.value }}
{% endfor %}

-- Auto-generated: the actual test selection needs to be manually placed into
-- the top-level so that real test data can be incrementally added.
--
-- This commented snippet is what the entire set should look like:

-- fixtures :: TestTree
-- fixtures =
--     [ testGroup "request"
--         {% for op in operations %}{% if op.first %}[{% else %},{% endif %} test{{ op.value.name }} $
--             {{ op.value.input.constructor.name }}
--
--         {% endfor %}  ]

--     , testGroup "response"
--         {% for op in operations %}{% if op.first %}[{% else %},{% endif %} test{{ op.value.name }}Response $
--             {{ op.value.output.constructor.name }}
--
--         {% endfor %}  ]
--     ]

-- Requests
{% for op in operations %}
  {% if op.value.input.eq %}

test{{ op.value.name }} :: {{ op.value.input.name }} -> TestTree
test{{ op.value.name }} = undefined
  {% endif %}
{% endfor %}

-- Responses
{% for op in operations %}
  {% if op.value.output.eq %}

test{{ op.value.name }}Response :: {{ op.value.output.name }} -> TestTree
test{{ op.value.name }}Response = resp
    "{{ op.value.name }}Response"
    "fixture/{{ op.value.name }}Response"
    (Proxy :: Proxy {{ op.value.input.name }})
  {% endif %}
{% endfor %}

{% for ty in types %}
  {% case ty.value.type %}
  {% when "product" %}
instance Out {{ ty.value.name }}
  {% when "sum" %}
instance Out {{ ty.value.name }}
  {% endcase %}
{% endfor %}
